# 📈 1Bo's Plan v2.0.0

**Advanced Stock Analysis Tool with Modular Architecture**

모듈형 구조로 재설계된 주식 분석 및 투자 계산 프로그램입니다. 특히 폭락장 상황에서의 합리적 투자 결정을 지원합니다.

## 🎯 주요 특징

### 📊 핵심 기능 (모두 완전 구현됨)
- **Yahoo Finance 연동**: 한국/미국 주식 데이터 자동 다운로드
- **한국 주식 검색**: 회사명으로 종목 코드 검색 및 선택
- **고급 차트**: 이동평균선, 기간 선택, 진입가 라인 표시
- **투자 계산기**: Single/DCA/Pyramid 전략 정밀 계산
- **폭락장 대응**: 정량적 위험 평가 및 손절/분할매수 판단
- **AI 자문 연동**: 상황 리포트 생성으로 전문 상담 요청

### 🚨 폭락장 대응 전문 시스템
- **위험 점수**: 0-100점 정량적 평가
- **심각도 등급**: NORMAL → MODERATE → SEVERE → EXTREME
- **레버리지 ETF 특별 관리**: SOXL, TQQQ 등 3배 위험 고려
- **객관적 손절가**: 보수적/표준/공격적 3단계 제시

## 🚀 빠른 시작

### 1. 설치 및 실행
```bash
# 1. 저장소 복제 또는 다운로드
git clone <repository-url>
cd stock_analyzer2

# 2. 간단 실행 (배치 파일 사용)
run.bat

# 또는 직접 실행
python main.py
```

### 2. 필수 패키지 설치
```bash
pip install -r requirements.txt
```

### 3. 첫 사용 가이드
1. **종목 선택**: Analysis 탭에서 AAPL, SOXL 또는 005930 등 입력
2. **한국 주식**: 🔍 버튼으로 회사명 검색 후 선택
3. **데이터 다운로드**: "📥 Download Data" 클릭
4. **포지션 입력**: 진입가와 보유량 입력 (선택사항)
5. **분석 실행**: "📈 Analyze" 클릭으로 차트 및 정보 확인

## 📋 모듈 구조

```
stock_analyzer2/
├── main.py                    # 메인 애플리케이션
├── config.py                  # 설정 파일
├── modules/                   # 모듈 패키지
│   ├── __init__.py
│   ├── utils.py               # 로깅, 에러처리, 유틸리티
│   ├── data_manager.py        # 데이터 다운로드/로드/관리
│   ├── korean_stock_manager.py # 한국 주식 검색/관리
│   ├── chart_manager.py       # 차트 생성/관리
│   ├── analysis_engine.py     # 기술적 분석
│   ├── investment_calculator.py # 투자 계산기
│   └── crash_analyzer.py      # 폭락장 대응 분석
├── data/                      # 다운로드된 주식 데이터
├── out/                       # 백업/정리된 파일
├── logs/                      # 로그 파일
├── requirements.txt           # Python 패키지 의존성
├── run.bat                   # Windows 실행 스크립트
└── README.md                 # 이 파일
```

## 💰 투자 계산기 사용법

### 투자 전략 유형
1. **Single (일괄투자)**: 한 번에 전체 금액 투자
2. **DCA (분할매수)**: 일정 금액을 정기적으로 투자
3. **Pyramid (피라미드)**: 하락 시 점진적으로 투자 증액

### 사용 예시
```
예산: $10,000
현재가: $100
전략: DCA (4회 분할)

결과:
- 회당 투자금: $2,500
- 예상 매수량: 25주 × 4회 = 100주
- 시나리오별 수익률 자동 계산
```

## 🚨 폭락장 대응 시스템

### 핵심 질문 해결
**"지금 손절해야 할까? 아니면 분할매수를 계속해야 할까?"**

이 프로그램은 이 어려운 질문에 대해 객관적이고 정량적인 답변을 제공합니다.

### 판단 기준
1. **기술적 지표 종합 분석**
   - RSI, MACD, 볼린저 밴드
   - 이동평균선 지지/저항
   - 거래량 패턴

2. **위험도 점수 (0-100점)**
   - 0-30: 안전 구간 (분할매수 적극 권장)
   - 31-60: 주의 구간 (신중한 분할매수)
   - 61-80: 위험 구간 (분할매수 보류 고려)
   - 81-100: 극위험 구간 (손절 적극 고려)

3. **레버리지 ETF 특별 기준**
   - 일반 주식보다 엄격한 기준 적용
   - 12-15% 하락 시 손절 고려
   - 변동성 급증 시 즉시 대응

### 실제 사용 시나리오

#### 시나리오 1: SOXL 15% 하락 상황
```
현재 상황:
- 진입가: $25.00
- 현재가: $21.25 (-15%)
- 보유량: 100주

분석 결과:
- 위험 점수: 75점 (위험)
- 권장 행동: 손절 고려
- 손절가: $20.00 (보수적 기준)
- 예상 손실: $500 (20%)

판단 근거:
- 반도체 섹터 전반적 악재
- 기술적 지표 모두 매도 신호
- 레버리지 ETF 특성상 빠른 회복 어려움
```

#### 시나리오 2: 삼성전자 10% 하락 상황
```
현재 상황:
- 진입가: 70,000원
- 현재가: 63,000원 (-10%)
- 보유량: 100주

분석 결과:
- 위험 점수: 45점 (주의)
- 권장 행동: 분할매수 유지
- 추가 매수가: 60,000원, 55,000원
- DCA 전략: 4회 분할로 위험 분산

판단 근거:
- 펀더멘탈 견고
- 기술적 지표 중립
- 장기 투자 관점에서 매력적
```

## 🤖 AI 자문 연동

### 상황 리포트 생성
복잡한 투자 상황에서 AI에게 전문적인 조언을 구할 수 있도록 현재 상황을 체계적으로 정리해 줍니다.

```
=== INVESTMENT SITUATION REPORT ===

종목: SOXL (3x 반도체 ETF)
현재 상황:
- 진입가: $25.00
- 현재가: $21.25 (-15.0%)
- 보유 주식: 100주
- 현재 손실: $375

기술적 분석:
- RSI: 28 (과매도)
- MACD: 매도 신호
- 볼린저 밴드: 하단 돌파

시장 상황:
- 반도체 업종: -12% (1개월)
- VIX 지수: 32 (공포 지수 상승)
- 금리 환경: 상승 추세

위험 평가:
- 위험 점수: 75/100 (위험)
- 심각도: SEVERE
- 권장 행동: 손절 고려

질문: 현재 상황에서 손절하는 것이 맞을까요, 아니면 추가 매수를 통해 평단가를 낮추는 것이 좋을까요?
```

## 📁 파일 관리

### 자동 파일 정리
- **데이터 파일**: `[종목명]_YYMMDD.csv` 형식으로 자동 저장
- **백업 관리**: 오래된 파일은 `out/` 폴더로 자동 이동
- **로그 관리**: 모든 분석 결과와 오류를 `logs/` 폴더에 기록

### 파일 명명 규칙
```
미국 주식: AAPL_241210.csv, SOXL_241210.csv
한국 주식: 005930_241210.csv, 000660_241210.csv
KRX 리스트: krx_stock_list.csv (한국 주식 코드/이름 매핑)
```

## 🔧 설정 및 커스터마이징

### config.py 주요 설정
```python
# 데이터 설정
DATA_FOLDER = "data"
BACKUP_FOLDER = "out"
MAX_DATA_AGE_DAYS = 30  # 30일 이상 된 데이터는 백업

# 차트 설정
CHART_THEME = "dark"  # "light" 또는 "dark"
MA_PERIODS = [5, 20, 50, 200]  # 이동평균선 기간

# 위험 평가 기준
RISK_THRESHOLDS = {
    "low": 30,      # 안전 구간
    "medium": 60,   # 주의 구간
    "high": 80      # 위험 구간
}

# 레버리지 ETF 손절 기준
LEVERAGE_CUTLOSS = {
    "conservative": -10,  # 보수적
    "standard": -15,      # 표준
    "aggressive": -20     # 공격적
}
```

## 🐛 트러블슈팅

### 자주 발생하는 문제들

#### 1. 모듈 임포트 오류
```
ModuleNotFoundError: No module named 'modules'
```
**해결방법**: 
- `pip install -r requirements.txt` 실행
- Python 경로 확인
- main.py가 프로젝트 루트에서 실행되는지 확인

#### 2. 한국 주식 검색 안됨
```
KRX 데이터를 찾을 수 없습니다.
```
**해결방법**:
- `krx_stock_list.csv` 파일이 프로젝트 루트에 있는지 확인
- 관련 스크립트 소스에서 KRX 리스트 다운로드 스크립트 실행

#### 3. 차트가 표시되지 않음
```
matplotlib 오류 발생
```
**해결방법**:
- `pip install matplotlib==3.7.0` (호환 버전 설치)
- GUI 백엔드 설정 확인

#### 4. Yahoo Finance 연결 실패
```
ConnectionError: Unable to fetch data
```
**해결방법**:
- 인터넷 연결 확인
- yfinance 업데이트: `pip install yfinance --upgrade`
- 프록시 설정 확인 (회사 환경)

### 에러 로그 활용
모든 오류는 `logs/error.log`에 기록됩니다. 문제 발생 시 이 파일을 확인하여 구체적인 오류 원인을 파악할 수 있습니다.

```bash
# 최근 오류 확인
tail -20 logs/error.log

# 특정 오류 검색
grep "ERROR" logs/error.log
```

## 📈 업데이트 계획

### v2.1.0 (예정)
- [ ] 포트폴리오 관리 기능
- [ ] 실시간 알림 시스템
- [ ] 더 많은 기술적 지표
- [ ] 백테스팅 기능

### v2.2.0 (예정)
- [ ] 옵션 전략 분석
- [ ] 섹터별 비교 분석
- [ ] 리스크 패리티 포트폴리오
- [ ] API 연동 (Discord, Telegram)

## 📞 지원 및 피드백

### 버그 리포트
- **로그 파일**: `logs/error.log` 첨부
- **실행 환경**: Python 버전, OS 정보
- **재현 단계**: 구체적인 실행 과정
- **스크린샷**: UI 오류 시 화면 캡처

### 기능 요청
- 구체적인 사용 사례
- 기대하는 동작 방식
- 우선순위 (High/Medium/Low)

## 📜 라이선스

이 프로젝트는 개인 사용 목적으로 개발되었습니다. 투자 결정은 본인의 책임 하에 이루어져야 하며, 이 프로그램의 분석 결과에 대한 보장은 없습니다.

**면책 조항**: 이 프로그램은 투자 참고 도구일 뿐이며, 실제 투자 손실에 대한 책임은 사용자에게 있습니다.

## 🧪 테스트 상태

### ✅ 완료된 모듈
- [x] **config.py** - 설정 관리
- [x] **utils.py** - 로깅, 에러처리, 파일관리
- [x] **data_manager.py** - 데이터 다운로드/로드
- [x] **korean_stock_manager.py** - 한국주식 검색
- [x] **chart_manager.py** - 차트 생성/관리
- [x] **analysis_engine.py** - 기술적 분석
- [x] **investment_calculator.py** - 투자 계산기
- [x] **crash_analyzer.py** - 폭락장 대응 분석
- [x] **main.py** - 메인 애플리케이션
- [x] **krx_stock_list.csv** - 한국 주식 데이터 (샘플 50개 종목)

### 🚀 실행 준비 완료

**즉시 테스트 가능:**
```bash
cd D:\vscode\stock_analyzer2\
python main.py
```

**또는 배치파일 사용:**
```bash
run.bat
```

### 📋 테스트 시나리오

#### 1. 기본 기능 테스트
- [ ] 애플리케이션 실행
- [ ] 미국 주식 검색 (AAPL, SOXL)
- [ ] 한국 주식 검색 (005930, 삼성전자)
- [ ] 데이터 다운로드
- [ ] 차트 표시

#### 2. 투자 계산기 테스트
- [ ] Single 투자 계산
- [ ] DCA 분할매수 계산
- [ ] Pyramid 전략 계산
- [ ] 위험 평가

#### 3. 폭락장 대응 테스트
- [ ] 폭락 상황 분석
- [ ] 손절가 계산
- [ ] AI 자문 리포트 생성

---

*마지막 업데이트: 2024년 12월 10일*
*버전: v2.0.0*
*개발 상태: 테스트 준비 완료* ✅