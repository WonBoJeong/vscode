# 📈 VStock Advanced Pro v3.3 - 완전 기능 버전

**폭락장 대응 전문 분석 도구 - 투자 계산기 + 차트 분석 + AI 자문**

> **"감정이 아닌 데이터로, 추측이 아닌 분석으로, 혼자가 아닌 AI와 함께"**

---

## 🎉 v3.3 주요 업데이트 (완전 기능 구현)

### ✅ **핵심 문제 해결**: 
**"레버리지 ETF 폭락장에서 손절 vs 분할매수의 어려운 결정"**이 완전히 해결되었습니다!

### 🚀 **완전 구현된 기능들**:
- 💰 **투자 계산기**: Single/DCA/Pyramid 전략 정밀 계산
- 🚨 **폭락장 대응 전략**: 0-100점 위험 점수 + 손절 레벨 계산
- ⚡ **레버리지 ETF 전용 관리**: SOXL, TQQQ 등 특별 위험 관리
- 🤖 **AI 자문 시스템**: 상황 리포트 자동 생성 + 클립보드 복사
- 📊 **위험도 정밀 평가**: VaR 계산 + 시나리오 분석

---

## 🛠️ 설치 및 실행

### **빠른 시작**:
```bash
# 1. 기존 파일 백업
copy vstock_main.py vstock_main_backup.py

# 2. 새 파일로 교체 (아티팩트에서 다운로드한 vstock_main_complete.py를)
copy vstock_main_complete.py vstock_main.py

# 3. 실행
run.bat
# 또는
python vstock_main.py
```

### **필수 라이브러리**:
```bash
pip install pandas numpy matplotlib yfinance tkinter pathlib
```

---

## 📊 주요 기능 상세

### 1️⃣ **📈 Analysis (차트 분석)**
- **한국/미국 주식 지원**: 005930 (삼성전자), AAPL, SOXL 등
- **Yahoo Finance 연동**: 자동 데이터 다운로드
- **차트 기능**: 30일~10년 기간별, MA5/20/60/200 이동평균선
- **인기/내 종목 버튼**: 빠른 종목 선택
- **진입가 표시**: 포지션 정보 및 손익 자동 계산

### 2️⃣ **💰 Investment Calculator (완전 구현)**

#### **🧮 투자 전략 계산**:
- **Single**: 일괄 투자
  - 수수료 고려한 정확한 계산
  - 5%/10%/20% 수익 목표가 자동 계산
  - 5%/10%/15% 손절가 자동 계산

- **DCA (Dollar Cost Averaging)**: 분할 매수
  - 2~20회 분할 설정 가능
  - 4가지 시장 시나리오별 성과 분석
  - 평단가 효과 정밀 계산

- **Pyramid**: 피라미드 매수
  - 하락률별 증액 투자 계산
  - 레벨별 상세 실행 계획
  - 위험/수익 비율 분석

#### **📊 고급 분석 도구**:
- **위험 평가**: 연환산 변동성, VaR 95%/99%, 최대낙폭
- **수익 목표 계산**: 보수적/표준/공격적 목표가 설정
- **시나리오 분석**: 8가지 시장 상황별 손익 시뮬레이션
- **전략 추천**: 변동성 기반 최적 전략 제안

### 3️⃣ **🚨 Crash Strategy (완전 구현)**

#### **🚨 종합 폭락 분석**:
- **0-100점 위험 점수**: 정량적 심각도 평가
- **5단계 등급**: NORMAL → MODERATE → SEVERE → EXTREME
- **다중 시간 프레임**: 5일/10일/20일/60일/52주 하락률 분석
- **위험 요소 분해**: 하락심각도(35점) + 변동성(25점) + 거래량(15점) + 추세파괴(15점) + 연속하락(10점)

#### **✂️ 최적 손절 레벨 계산**:
- **일반 주식**: 10%/15%/20% (보수적/표준/공격적)
- **레버리지 ETF**: 12%/15%/18% (더 엄격한 기준)
- **절대 손절선**: 레버리지 ETF 20% 돌파 절대 금지
- **VIX 연동**: 30 이상 시 즉시 청산 고려

#### **📊 위험도 정밀 평가**:
- **VaR 계산**: 95%, 99% 신뢰구간
- **위험 등급**: 낮음/보통/높음/매우높음 자동 분류
- **구체적 권장사항**: 등급별 상세 투자 가이드라인

#### **📋 AI 자문용 리포트**:
- **상황 정리**: 현재 투자 딜레마 객관적 요약
- **클립보드 복사**: 클로드 등 AI에게 바로 상담 요청
- **전문가급 리포트**: 데이터 기반 상황 분석

### 4️⃣ **⚡ 레버리지 ETF 특별 관리**

#### **자동 인식 종목**:
- SOXL, TQQQ, UPRO, TMF, SPXL, TECL, FNGU, WEBL, TSLL

#### **특별 위험 관리**:
- **30% 위험 가산점**: 일반 주식 대비 더 높은 위험 점수
- **3배 레버리지 효과**: 기초자산 대비 예상 움직임 계산
- **변동성 손실**: 일일 리밸런싱 손실 + 시간가치 손실 추정
- **장기보유 경고**: 30일 이상 보유 절대 지양

---

## 🎯 실제 사용 시나리오

### **시나리오 1: SOXL 급락 상황 대응**
```
1. Analysis 탭 → SOXL 입력
2. 진입가: $25, 보유량: 100주 입력
3. 🚨 Crash Strategy 탭 이동
4. "종합 폭락 분석" 실행
   → 위험점수 85점, SEVERE_CRASH 등급
   → 권장: "심각 - 즉시 대응 필요"
5. "최적 손절 레벨 계산" 실행
   → 보수적: $22.00 (12% 손절)
   → 표준: $21.25 (15% 손절)
6. "AI 자문용 리포트 생성" → 클립보드 복사
7. 클로드에게 상황 요약 붙여넣기로 전문 상담
```

### **시나리오 2: 분할매수 전략 수립**
```
1. Analysis 탭 → AAPL 데이터 다운로드
2. Investment Calculator 탭 이동
3. 예산: $10,000, 전략: DCA, 분할: 4회
4. "Calculate Position" 실행
   → 회차별 상세 계산 결과 확인
   → 4가지 시장 시나리오별 성과 분석
5. "Scenario Analysis" 추가 분석
6. "Risk Assessment" 위험도 평가
```

### **시나리오 3: 한국 주식 피라미드 전략**
```
1. Analysis 탭 → 005930 (삼성전자) 입력
2. Investment Calculator 탭
3. 예산: 1,000만원, 전략: Pyramid, 5단계, 하락률: 5%
4. "Calculate Position" 실행
   → 레벨별 매수가격과 투자금액 계산
   → 평단가 및 수익 시나리오 분석
```

---

## 📁 프로젝트 구조

```
D:\vscode\stock_analyzer\
├── vstock_main.py              # 메인 애플리케이션 (v3.3 완전 기능)
├── data/                       # 주식 데이터 저장소
│   ├── AAPL_250610.csv        # 미국 주식 데이터
│   ├── 005930_250610.csv      # 한국 주식 데이터
│   └── ...
├── out/                        # 백업 및 이전 버전들
│   ├── vstock_main_backup.py  # 백업 파일
│   └── ...
├── krx_stock_list.csv         # 한국 주식 종목 리스트
├── requirements.txt           # Python 의존성
├── run.bat                    # 실행 스크립트
└── README.md                  # 이 파일
```

---

## 🔧 고급 설정

### **종목 리스트 편집**:
- Analysis 탭 → "종목 편집" 버튼
- 인기 종목 / 내 종목 커스터마이징 가능
- JSON 파일 자동 저장

### **차트 설정**:
- 기간: 30일 ~ 10년
- 이동평균: MA5/20/60/200 선택적 표시
- 진입가 라인 자동 표시
- PNG/PDF 저장 기능

### **파일 관리**:
- 자동 파일명: [종목명]_YYMMDD.csv
- 30일 이상 파일 자동 정리 (out 폴더 이동)
- 파일 정보 상세 표시

---

## ⚠️ 중요 안내사항

### **투자 원칙**:
1. **손실 제한 우선**: "손실을 제한하는 것이 먼저, 수익은 그 다음"
2. **객관적 판단**: 감정이 아닌 데이터 기반 결정
3. **위험 관리**: 절대 감당할 수 없는 손실 금지
4. **AI 자문 활용**: 복잡한 상황에서 전문가 의견 참고

### **레버리지 ETF 특별 주의**:
- **12-15% 손절선 엄격 준수**
- **30일 이상 장기보유 절대 지양**
- **변동성 급증 시 즉시 대응**
- **일반 주식 대비 3배 위험 인식**

### **면책 조항**:
- 이 도구는 투자 참고용입니다
- 최종 투자 결정은 본인의 판단과 책임
- 과거 성과는 미래 수익을 보장하지 않음
- 모든 투자에는 손실 위험이 있음

---

## 🆘 문제 해결

### **일반적인 문제**:

1. **"모듈을 찾을 수 없습니다" 오류**:
   ```bash
   pip install pandas numpy matplotlib yfinance
   ```

2. **차트가 표시되지 않음**:
   - matplotlib 재설치: `pip uninstall matplotlib && pip install matplotlib`

3. **한글이 깨져서 나타남**:
   - Windows: 시스템 폰트 확인 (Malgun Gothic)
   - 인코딩 설정: UTF-8

4. **데이터 다운로드 실패**:
   - 인터넷 연결 확인
   - 종목 코드 정확성 확인 (US: AAPL, KR: 005930)

### **에러 리포팅**:
- 모든 에러는 복사 가능한 창에 표시됩니다
- "Copy to Clipboard" 버튼으로 에러 정보 복사
- 클로드에게 에러 정보 붙여넣기로 해결책 문의

---

## 🔄 업데이트 이력

### **v3.3.0 (2024-06-10) - 완전 기능 구현**
- ✅ 투자 계산기 완전 구현 (Single/DCA/Pyramid)
- ✅ 폭락장 대응 전략 완전 구현 (위험점수/손절계산/AI자문)
- ✅ 레버리지 ETF 특별 관리 시스템
- ✅ VaR 기반 정밀 위험 평가
- ✅ AI 자문용 리포트 자동 생성
- ✅ 사용자 핵심 요구사항 100% 해결

### **v3.2.0 (이전 버전)**
- 차트 개선 및 UI 향상
- 인기종목/내종목 버튼 추가
- 에러 처리 시스템 개선

### **v3.1.0 (이전 버전)**
- 기본 차트 및 데이터 분석 기능

---

## 🤝 지원 및 문의

### **AI 자문 활용**:
이 도구의 "AI 자문용 리포트 생성" 기능을 통해 복잡한 투자 상황에서 클로드 등 AI에게 전문적인 조언을 구할 수 있습니다.

### **지속적인 개선**:
사용 중 개선사항이나 추가 기능이 필요하시면 README 파일에 요구사항을 기록해 두시면, 다음 채팅 세션에서 연속적으로 개발을 이어갈 수 있습니다.

---

## 💡 투자 철학

> **"데이터로 말하고, 숫자로 판단하고, 계획으로 실행한다"**

VStock Advanced Pro v3.3는 감정적 투자 결정을 배제하고, 객관적 데이터에 기반한 합리적 투자 결정을 돕는 도구입니다. 

특히 폭락장에서 "손절 vs 분할매수"의 어려운 결정을 내릴 때, 이제 더 이상 혼자 고민하지 마세요. 정량적 위험 점수와 AI 자문을 통해 현명한 선택을 하시기 바랍니다.

**행운을 빕니다! 🚀**

---

*Generated by VStock Advanced Pro v3.3 Development Team*  
*Last Updated: 2024-06-10*